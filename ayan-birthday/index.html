<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy Birthday Ayan!</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Updated QR code script source -->
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.1/build/qrcode.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a0a2e, #2d0b5a, #4a1b8c, #ff1493);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            color: #fff;
            min-height: 100vh;
            overflow-x: hidden;
            padding: 20px;
        }
        
        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 10;
        }
        
        /* Header with controls */
        header {
            text-align: center;
            padding: 40px 0 20px;
            animation: fadeInDown 1s ease;
            position: relative;
        }
        
        .controls {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 15px;
            z-index: 100;
        }
        
        .control-btn {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }
        
        .control-btn:hover {
            transform: scale(1.1);
            background: rgba(255, 255, 255, 0.25);
        }
        
        h1 {
            font-size: 4rem;
            margin-bottom: 10px;
            text-shadow: 0 0 15px rgba(255, 215, 0, 0.7);
            background: linear-gradient(to right, #ffd700, #ff8c00, #ff4500);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: 2px;
        }
        
        .name-highlight {
            font-size: 5rem;
            display: block;
            margin-top: 10px;
            text-shadow: 0 0 20px rgba(255, 105, 180, 0.8);
            background: linear-gradient(to right, #ff69b4, #ff1493, #ff00ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: pulse 2s infinite;
        }
        
        .subtitle {
            font-size: 1.5rem;
            margin-bottom: 30px;
            opacity: 0.9;
        }
        
        /* Birthday card section */
        .birthday-card {
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            margin: 30px 0;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            animation: fadeInUp 1s ease;
        }
        
        .message {
            font-size: 1.2rem;
            line-height: 1.8;
            text-align: center;
            margin-bottom: 30px;
            padding: 0 20px;
        }
        
        .message p {
            margin-bottom: 20px;
            text-align: justify;
        }
        
        /* Photo gallery */
        .photo-gallery {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 30px;
            margin: 50px 0;
        }
        
        .photo-card {
            width: 300px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
            transition: transform 0.4s ease, box-shadow 0.4s ease;
            position: relative;
        }
        
        .photo-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
        }
        
        .photo-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(to right, #ff69b4, #ff1493, #ff00ff);
        }
        
        .photo-img {
            width: 100%;
            height: 250px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        
        .photo-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }
        
        .photo-card:hover .photo-img img {
            transform: scale(1.1);
        }
        
        .photo-info {
            padding: 20px;
            text-align: center;
        }
        
        .photo-info h3 {
            font-size: 1.4rem;
            margin-bottom: 10px;
            color: #ffd700;
        }
        
        .photo-info p {
            font-size: 1rem;
            opacity: 0.8;
        }
        
        /* Interactive section */
        .interactive-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 30px;
            margin: 50px 0;
        }
        
        .cake-container {
            position: relative;
            width: 300px;
            height: 300px;
            margin: 20px auto;
            cursor: pointer;
            perspective: 1000px;
        }
        
        .cake {
            position: relative;
            width: 100%;
            height: 100%;
            transform-style: preserve-3d;
            transition: transform 1s ease;
        }
        
        .cake-top, .cake-bottom {
            position: absolute;
            width: 100%;
            height: 50%;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            backface-visibility: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .cake-top {
            top: 0;
            background: linear-gradient(to bottom, #ffd700, #ff8c00);
            border-top-left-radius: 15px;
            border-top-right-radius: 15px;
            transform-origin: bottom center;
        }
        
        .cake-bottom {
            bottom: 0;
            background: linear-gradient(to bottom, #ff1493, #ff00ff);
            border-bottom-left-radius: 15px;
            border-bottom-right-radius: 15px;
        }
        
        .cake-top::after, .cake-bottom::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 20px;
            background: rgba(255,255,255,0.3);
        }
        
        .cake-top::after {
            bottom: 0;
        }
        
        .cake-bottom::after {
            top: 0;
        }
        
        .candle {
            position: absolute;
            top: -40px;
            left: 50%;
            transform: translateX(-50%);
            width: 15px;
            height: 40px;
            background: linear-gradient(to bottom, #ff4500, #ff8c00);
            border-radius: 5px 5px 0 0;
            z-index: 5;
            transition: opacity 0.5s ease;
        }
        
        .flame {
            position: absolute;
            top: -60px;
            left: 50%;
            transform: translateX(-50%);
            width: 20px;
            height: 40px;
            background: linear-gradient(to bottom, #ffff00, #ff4500);
            border-radius: 50% 50% 20% 20%;
            box-shadow: 0 0 20px #ff8c00, 0 0 40px #ff4500;
            animation: flicker 0.8s infinite alternate;
            transition: opacity 0.5s ease;
        }
        
        .cake-message {
            color: white;
            font-weight: bold;
            font-size: 1.5rem;
            text-align: center;
            z-index: 2;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }
        
        .cake-container:hover .cake {
            transform: rotateX(10deg);
        }
        
        .cake-container.cut .cake-top {
            animation: cutCake 1.5s ease-out forwards;
        }
        
        .wish-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 30px;
            width: 100%;
            max-width: 600px;
            text-align: center;
        }
        
        .wish-card h2 {
            font-size: 2rem;
            margin-bottom: 20px;
            color: #ffd700;
        }
        
        .wish-input {
            width: 100%;
            padding: 15px;
            border-radius: 50px;
            border: none;
            margin: 15px 0;
            background: rgba(255, 255, 255, 0.15);
            color: white;
            font-size: 1rem;
            text-align: center;
        }
        
        .wish-input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }
        
        .btn {
            background: linear-gradient(to right, #ff69b4, #ff1493);
            color: white;
            border: none;
            padding: 12px 35px;
            border-radius: 50px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px;
            font-weight: bold;
            letter-spacing: 1px;
        }
        
        .btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(255, 20, 147, 0.4);
        }
        
        .countdown {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 40px 0;
            flex-wrap: wrap;
        }
        
        .countdown-box {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 20px;
            min-width: 100px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .countdown-value {
            font-size: 2.5rem;
            font-weight: bold;
            color: #ffd700;
        }
        
        .countdown-label {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-top: 5px;
        }
        
        /* Confetti, hearts, balloons */
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background-color: #ffd700;
            top: -10px;
            animation: confetti-fall 5s linear infinite;
            z-index: 1;
        }
        
        .heart {
            position: fixed;
            font-size: 2rem;
            color: #ff6b6b;
            top: -50px;
            z-index: 1;
            animation: heart-rise 8s linear forwards;
            text-shadow: 0 0 10px rgba(255, 0, 0, 0.5);
        }
        
        .balloon {
            position: fixed;
            width: 50px;
            height: 60px;
            border-radius: 50%;
            bottom: -100px;
            animation: balloon-rise 10s linear forwards;
            z-index: 1;
            box-shadow: inset -5px -5px 10px rgba(0,0,0,0.2);
        }
        
        .balloon::after {
            content: '';
            position: absolute;
            width: 2px;
            height: 80px;
            background: rgba(255,255,255,0.5);
            bottom: -80px;
            left: 50%;
            transform: translateX(-50%);
        }
        
        .crumb {
            position: absolute;
            width: 8px;
            height: 8px;
            background: #ffd700;
            border-radius: 50%;
            z-index: 2;
            animation: crumb-fly 1s ease-out forwards;
        }
        
        @keyframes confetti-fall {
            0% { transform: translateY(0) rotate(0); opacity: 1; }
            100% { transform: translateY(100vh) rotate(360deg); opacity: 0; }
        }
        
        @keyframes heart-rise {
            0% { transform: translateY(0) translateX(0) scale(0.5); opacity: 1; }
            100% { transform: translateY(-100vh) translateX(calc(-50vw + 100px)) scale(1.5); opacity: 0; }
        }
        
        @keyframes balloon-rise {
            0% { transform: translateY(0) rotate(0); opacity: 1; }
            100% { transform: translateY(-100vh) rotate(10deg); opacity: 0; }
        }
        
        @keyframes crumb-fly {
            0% { transform: translate(0, 0) scale(0); opacity: 1; }
            100% { 
                transform: translate(
                    calc(var(--tx) * 100px), 
                    calc(var(--ty) * 100px)
                ) scale(1); 
                opacity: 0;
            }
        }
        
        /* Footer with QR code */
        footer {
            text-align: center;
            padding: 30px 0;
            margin-top: 40px;
            font-size: 1rem;
            opacity: 0.8;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .hearts {
            color: #ff6b6b;
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
        
        @keyframes fadeInDown {
            from { opacity: 0; transform: translateY(-50px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(50px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes flicker {
            0% { transform: translateX(-50%) scale(1); opacity: 1; }
            50% { transform: translateX(-50%) scale(1.1); opacity: 0.9; }
            100% { transform: translateX(-50%) scale(0.9); opacity: 1; }
        }
        
        @keyframes cutCake {
            0% { transform: rotateX(0); }
            30% { transform: rotateX(-90deg); }
            70% { transform: rotateX(-90deg) translateY(-80px); }
            100% { transform: rotateX(-90deg) translateY(-150px) rotate(15deg); }
        }
        
        @keyframes cutEffect {
            0% { transform: translateX(-50%) scale(0); opacity: 1; }
            50% { transform: translateX(-50%) scale(1); opacity: 1; }
            100% { transform: translateX(-50%) scale(1.2); opacity: 0; }
        }
        
        .age-tag {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(255, 215, 0, 0.9);
            color: #1a0a2e;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            z-index: 2;
        }
        
        .floating {
            animation: floating 3s ease-in-out infinite;
        }
        
        @keyframes floating {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-15px); }
            100% { transform: translateY(0px); }
        }
        
        /* QR Code Section - Enhanced styling */
        .qr-section {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 20px;
            padding: 30px;
            margin: 40px auto;
            max-width: 600px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.15);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            animation: fadeInUp 1s ease;
        }
        
        .qr-container {
            margin: 20px auto;
            width: 180px;
            height: 180px;
            background: white;
            padding: 15px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            border: 5px solid #ffd700;
        }
        
        .qr-image {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        
        .qr-instructions {
            margin: 15px 0;
            font-size: 1.1rem;
            color: #ffd700;
        }
        
        .download-card {
            margin-top: 30px;
            padding: 15px;
            background: linear-gradient(45deg, #ff8c00, #ff1493);
            border-radius: 15px;
            display: inline-block;
            cursor: pointer;
            transition: transform 0.3s ease;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .download-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(255, 20, 147, 0.5);
        }
        
        .download-card i {
            font-size: 2rem;
            margin-right: 10px;
            vertical-align: middle;
        }
        
        /* Cutting effect */
        .cutting-effect {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 40px;
            height: 200px;
            background: linear-gradient(to right, transparent 0%, rgba(255,255,255,0.8) 50%, transparent 100%);
            transform: translateX(-50%);
            opacity: 0;
            z-index: 20;
        }
        
        /* Music notification */
        .music-notification {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 10px 20px;
            border-radius: 30px;
            display: flex;
            align-items: center;
            gap: 10px;
            z-index: 100;
            animation: slideIn 0.5s ease;
        }
        
        @keyframes slideIn {
            from { transform: translateX(-100%); }
            to { transform: translateX(0); }
        }
        
        /* Responsive design */
        @media (max-width: 768px) {
            h1 { font-size: 2.5rem; }
            .name-highlight { font-size: 3rem; }
            .subtitle { font-size: 1.2rem; }
            .photo-card { width: 100%; max-width: 350px; }
            .birthday-card { padding: 25px; }
            .cake-container { width: 250px; height: 250px; }
            .controls { top: 10px; right: 10px; }
            .control-btn { width: 40px; height: 40px; }
            .qr-section { padding: 20px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Audio element for background music -->
        <audio id="birthdayAudio" loop>
            <source src="happy_birthday.mp3" type="audio/mpeg">
        </audio>
        
        <!-- Music notification -->
        <div class="music-notification" id="musicNotification">
            <i class="fas fa-music"></i>
            <span>Click anywhere to start the music!</span>
        </div>
        
        <!-- Header with controls -->
        <header>
            <div class="controls">
                <div class="control-btn" id="musicToggle">
                    <i class="fas fa-volume-up"></i>
                </div>
                <div class="control-btn" id="downloadCard">
                    <i class="fas fa-download"></i>
                </div>
            </div>
            
            <h1>Happy Birthday</h1>
            <div class="name-highlight floating">Ayan!</div>
            <div class="subtitle">Celebrating the Amazing Person You Are</div>
        </header>
        
        <!-- Birthday card with message -->
        <div class="birthday-card">
            <div class="message">
                <p>Dear Ayan, on this special day, I want to celebrate the incredible journey of your life. From the adorable baby pictures that melt our hearts to the remarkable person you've become today, every moment has been a treasure.</p>
                
                <p>I remember when you were just a little kid, full of curiosity and wonder. Those childhood adventures we shared - building forts, chasing fireflies, and dreaming big dreams - those memories are forever etched in my heart. Today, as you celebrate another year, I see the same spark in your eyes, now coupled with wisdom and maturity.</p>
                
                <p>Your journey through life has been inspiring to witness. From your first steps to your latest achievements, you've grown into someone truly special. Your kindness, intelligence, and sense of humor light up every room you enter. May this year bring you closer to your dreams, fill your days with joy, and surround you with love.</p>
                
                <p>Here's to creating many more beautiful memories together! With all my love and warmest wishes on your special day!</p>
            </div>
            
            <div class="countdown">
                <div class="countdown-box">
                    <div class="countdown-value" id="days">0</div>
                    <div class="countdown-label">Days</div>
                </div>
                <div class="countdown-box">
                    <div class="countdown-value" id="hours">0</div>
                    <div class="countdown-label">Hours</div>
                </div>
                <div class="countdown-box">
                    <div class="countdown-value" id="minutes">0</div>
                    <div class="countdown-label">Minutes</div>
                </div>
                <div class="countdown-box">
                    <div class="countdown-value" id="seconds">0</div>
                    <div class="countdown-label">Seconds</div>
                </div>
            </div>
        </div>
        
        <!-- Photo gallery -->
        <h2 style="text-align: center; margin: 40px 0 20px; font-size: 2.5rem; color: #ffd700;">Ayan's Journey Through Time</h2>
        
        <div class="photo-gallery">
            <div class="photo-card">
                <div class="age-tag">your memories</div>
                <div class="photo-img">
                    <img src="1.jpg" alt="Ayan as a baby">
                </div>
                <div class="photo-info">
                    <h3>The Early Years</h3>
                    <p>the pictures that always make us smile</p>
                </div>
            </div>
            
            <div class="photo-card">
                <div class="age-tag"></div>
                <div class="photo-img">
                    <img src="2.jpg" alt="Childhood Ayan">
                </div>
                <div class="photo-info">
                    <h3>Childhood Adventures</h3>
                    <p>School days, playground fun, and first adventures</p>
                </div>
            </div>
            
            <div class="photo-card">
                <div class="age-tag">Age 14</div>
                <div class="photo-img">
                    <img src="4.jpg" alt="Teenage Ayan">
                </div>
                <div class="photo-info">
                    <h3>Teenage Years</h3>
                    <p>Discovering passions and finding your path</p>
                </div>
            </div>
            
            <div class="photo-card">
                <div class="age-tag">Today</div>
                <div class="photo-img">
                    <img src="3.jpg" alt="Today's Ayan">
                </div>
                <div class="photo-info">
                    <h3>Today's Amazing You</h3>
                    <p>The wonderful person you've become</p>
                </div>
            </div>
        </div>
        
        <!-- Interactive cake section -->
        <div class="interactive-section">
            <h2 style="text-align: center; margin: 20px 0; font-size: 2.5rem; color: #ffd700;">Cut the Birthday Cake!</h2>
            <div class="cake-container" id="cakeContainer">
                <div class="cake">
                    <div class="cake-top">
                        <div class="cake-message">Ayan</div>
                    </div>
                    <div class="cake-bottom"></div>
                    <div class="candle"></div>
                    <div class="flame"></div>
                </div>
            </div>
            
            <div class="wish-card">
                <h2>Send Ayan a Birthday Wish</h2>
                <input type="text" class="wish-input" id="wishInput" placeholder="Type your personal wish here...">
                <button class="btn" onclick="showWish()">Send Your Wish</button>
                <div id="wishDisplay" style="margin-top: 20px; min-height: 50px;"></div>
            </div>
        </div>
        
        <!-- QR Code Section - Fixed -->
        <div class="qr-section">
            <h2 style="font-size: 2rem; margin-bottom: 20px; color: #ffd700;">Share This Birthday Tribute</h2>
            <p>Scan this QR code to open this page on any device</p>
            <div class="qr-container">
                <canvas id="qrcodeCanvas"></canvas>
            </div>
            <div class="qr-instructions">Point your camera at the code to open the page</div>
            
            <div class="download-card" id="downloadTrigger">
                <i class="fas fa-gift"></i>
                <span>Download Digital Birthday Card</span>
            </div>
        </div>
        
        <footer>
            <p>Created with <span class="hearts">❤️❤️❤️</span> for my amazing cousin Ayan on this special day</p>
            <p>© 2023 Birthday Tribute | Forever in our hearts</p>
            <h1> CREATED BY KHAN FAMILY especially for SYED AYAN ALI</h1>
        </footer>
    </div>

    <script>
        // Initialize variables
        let audioEnabled = false;
        const audio = document.getElementById('birthdayAudio');
        
        // Music will play after first user interaction
        document.body.addEventListener('click', function initAudio() {
            if (!audioEnabled) {
                audio.play().then(() => {
                    audioEnabled = true;
                    document.getElementById('musicNotification').innerHTML = `
                        <i class="fas fa-music"></i>
                        <span>Birthday music is playing!</span>
                        <button class="control-btn" id="closeNotification" style="background: rgba(255,255,255,0.2);">
                            <i class="fas fa-times"></i>
                        </button>
                    `;
                    document.getElementById('closeNotification').addEventListener('click', function() {
                        document.getElementById('musicNotification').style.display = 'none';
                    });
                }).catch(e => {
                    console.log("Audio play failed:", e);
                    document.getElementById('musicNotification').innerHTML = `
                        <i class="fas fa-exclamation-circle"></i>
                        <span>Could not play music. Please check browser settings.</span>
                    `;
                });
            }
            // Remove the event listener after first interaction
            document.body.removeEventListener('click', initAudio);
        }, { once: true });
        
        // Confetti effect
        function createConfetti() {
            const colors = ['#ffd700', '#ff69b4', '#ff1493', '#ff00ff', '#ffffff'];
            for (let i = 0; i < 150; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + 'vw';
                    confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.width = Math.random() * 10 + 5 + 'px';
                    confetti.style.height = confetti.style.width;
                    confetti.style.animationDuration = Math.random() * 3 + 2 + 's';
                    document.body.appendChild(confetti);
                    
                    setTimeout(() => {
                        confetti.remove();
                    }, 5000);
                }, i * 30);
            }
        }
        
        // Create hearts
        function createHearts() {
            for (let i = 0; i < 50; i++) {
                setTimeout(() => {
                    const heart = document.createElement('div');
                    heart.className = 'heart';
                    heart.innerHTML = '❤';
                    heart.style.left = Math.random() * 100 + 'vw';
                    heart.style.animationDuration = Math.random() * 3 + 5 + 's';
                    document.body.appendChild(heart);
                    
                    setTimeout(() => {
                        heart.remove();
                    }, 8000);
                }, i * 100);
            }
        }
        
        // Create balloons
        function createBalloons() {
            const colors = ['#ff6b6b', '#4ecdc4', '#ffd166', '#06d6a0', '#118ab2', '#ef476f'];
            for (let i = 0; i < 30; i++) {
                setTimeout(() => {
                    const balloon = document.createElement('div');
                    balloon.className = 'balloon';
                    balloon.style.left = Math.random() * 100 + 'vw';
                    balloon.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    balloon.style.animationDuration = Math.random() * 5 + 8 + 's';
                    document.body.appendChild(balloon);
                    
                    setTimeout(() => {
                        balloon.remove();
                    }, 10000);
                }, i * 200);
            }
        }
        
        // Create cake crumbs
        function createCrumbs() {
            for (let i = 0; i < 20; i++) {
                setTimeout(() => {
                    const crumb = document.createElement('div');
                    crumb.className = 'crumb';
                    crumb.style.left = '50%';
                    crumb.style.top = '50%';
                    crumb.style.setProperty('--tx', (Math.random() - 0.5) * 2);
                    crumb.style.setProperty('--ty', (Math.random() - 0.5) * 2);
                    crumb.style.animationDuration = Math.random() * 0.5 + 0.5 + 's';
                    document.getElementById('cakeContainer').appendChild(crumb);
                    
                    setTimeout(() => {
                        crumb.remove();
                    }, 1000);
                }, i * 50);
            }
        }
        
        // Create cutting effect
        function createCuttingEffect() {
            const effect = document.createElement('div');
            effect.className = 'cutting-effect';
            effect.style.animation = 'cutEffect 0.8s ease-out forwards';
            document.getElementById('cakeContainer').appendChild(effect);
            
            setTimeout(() => {
                effect.remove();
            }, 800);
        }
        
        // Countdown to next birthday
        function updateCountdown() {
            const now = new Date();
            const nextBirthday = new Date(now.getFullYear() + 1, 6, 15); // Month is 0-indexed (6 = July)
            if (now > nextBirthday) {
                nextBirthday.setFullYear(nextBirthday.getFullYear() + 1);
            }
            
            const diff = nextBirthday - now;
            
            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((diff % (1000 * 60)) / 1000);
            
            document.getElementById('days').textContent = days;
            document.getElementById('hours').textContent = hours;
            document.getElementById('minutes').textContent = minutes;
            document.getElementById('seconds').textContent = seconds;
            
            setTimeout(updateCountdown, 1000);
        }
        
        // Show personalized wish
        function showWish() {
            const wishInput = document.getElementById('wishInput');
            const wishDisplay = document.getElementById('wishDisplay');
            
            if (wishInput.value.trim() !== '') {
                wishDisplay.innerHTML = `
                    <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 10px; animation: fadeInUp 0.5s ease;">
                        <h3>Your Special Message to Ayan:</h3>
                        <p>"${wishInput.value}"</p>
                        <p style="margin-top: 15px; color: #ffd700;">This message is floating up to the birthday stars!</p>
                    </div>
                `;
                wishInput.value = '';
                
                // Create floating animation
                createConfetti();
            }
        }
        
        // Generate QR Code - Fixed Implementation
        function generateQRCode() {
            const canvas = document.getElementById('qrcodeCanvas');
            const pageUrl = window.location.href;
            
            QRCode.toCanvas(canvas, pageUrl, {
                width: 150,
                margin: 0,
                color: {
                    dark: '#000000',
                    light: '#ffffff'
                }
            }, function (error) {
                if (error) {
                    console.error('QR code generation failed:', error);
                    // Fallback text
                    canvas.parentElement.innerHTML = '<p style="color:red;">QR Code failed to generate</p>';
                } else {
                    console.log('QR code generated successfully');
                }
            });
        }
        
        // Download as digital card
        function downloadAsCard() {
            const htmlContent = document.documentElement.outerHTML;
            const blob = new Blob([htmlContent], {type: 'text/html'});
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = 'Ayan-Birthday-Card.html';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
        
        // Initialize effects
        window.onload = function() {
            createConfetti();
            updateCountdown();
            generateQRCode(); // Fixed QR code generation
            
            // Create more confetti periodically
            setInterval(createConfetti, 15000);
            
            // Add cake cutting interaction
            const cakeContainer = document.getElementById('cakeContainer');
            cakeContainer.addEventListener('click', function() {
                if (!this.classList.contains('cut')) {
                    this.classList.add('cut');
                    
                    // Create cutting effect
                    createCuttingEffect();
                    
                    // Create crumbs
                    createCrumbs();
                    
                    // Fade out candle and flame
                    document.querySelector('.candle').style.opacity = '0';
                    document.querySelector('.flame').style.opacity = '0';
                    
                    // Create celebration effects
                    setTimeout(() => {
                        createConfetti();
                        createHearts();
                        createBalloons();
                    }, 500);
                    
                    // Play birthday sound if enabled
                    if (audioEnabled && !audio.paused) {
                        // Already playing
                    } else if (audioEnabled) {
                        audio.play().catch(e => console.log("Audio play failed:", e));
                    }
                }
            });
            
            // Music toggle
            const musicToggle = document.getElementById('musicToggle');
            musicToggle.addEventListener('click', function() {
                audioEnabled = !audioEnabled;
                
                if (audioEnabled) {
                    audio.play().catch(e => console.log("Audio play failed:", e));
                    this.innerHTML = '<i class="fas fa-volume-up"></i>';
                } else {
                    audio.pause();
                    this.innerHTML = '<i class="fas fa-volume-mute"></i>';
                }
            });
            
            // Download button
            document.getElementById('downloadTrigger').addEventListener('click', downloadAsCard);
            document.getElementById('downloadCard').addEventListener('click', downloadAsCard);
        };
    </script>
</body>
</html>